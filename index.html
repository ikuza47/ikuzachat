<!DOCTYPE html>
<html lang="ru" style="background-color: #0a0a0a; color: #f0f0f0;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">IkuzaChat - Настройки</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif'],
                    },
                    colors: {
                        'primary-bg': '#0a0a0a',
                        'card-bg': '#121212',
                        'border-color': '#262626',
                        'text-primary': '#f0f0f0',
                        'text-secondary': '#a0a0a0',
                        'accent-orange': '#f9c7a0',
                        'accent-orange-hover': '#fbd8c0',
                        'input-bg': '#1a1a1a',
                        'button-text': '#0a0a0a',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Стилизация input[type="color"] */
        .color-input-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .color-input-wrapper input[type="color"] {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            width: 100%;
            height: 40px;
            background: transparent;
            border: none;
            cursor: pointer;
            border-radius: 6px;
            padding: 0;
        }

        .color-input-wrapper::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(45deg, #ccc 25%, transparent 25%),
                linear-gradient(-45deg, #ccc 25%, transparent 25%),
                linear-gradient(45deg, transparent 75%, #ccc 75%),
                linear-gradient(-45deg, transparent 75%, #ccc 75%);
            background-size: 10px 10px;
            background-position: 0 0, 0 5px, 5px -5px, -5px 0px;
            border-radius: 6px;
            z-index: 1;
            pointer-events: none;
        }

        .color-input-wrapper input[type="color"]::-webkit-color-swatch {
            border: none;
            border-radius: 6px;
            padding: 0;
        }

        .color-input-wrapper input[type="color"]::-webkit-color-swatch-wrapper {
            border: none;
            padding: 0;
            border-radius: 6px;
        }

        .color-input-wrapper input[type="color"]::-moz-color-swatch {
            border: none;
            border-radius: 6px;
        }

        /* Стиль для слайдера прозрачности */
        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .slider {
            -webkit-appearance: none;
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #262626;
            outline: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #f9c7a0;
            cursor: pointer;
        }

        .slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #f9c7a0;
            cursor: pointer;
            border: none;
        }

        .slider-value {
            min-width: 40px;
            text-align: center;
            color: #f9c7a0;
            font-weight: 500;
        }
    </style>
</head>
<body class="min-h-screen p-4 md:p-6 bg-primary-bg text-text-primary">
    <div class="max-w-4xl mx-auto">
        <!-- Заголовок -->
        <header class="flex flex-col sm:flex-row justify-between items-center gap-4 mb-6 p-4 bg-card-bg rounded-lg border border-border-color">
            <div class="flex items-center gap-3">
                <img src="logo.png" alt="IkuzaChat Logo" class="w-10 h-10 rounded-full border border-accent-orange/50">
                <h1 id="mainTitle" class="text-xl md:text-2xl font-bold text-white">IkuzaChat</h1>
            </div>
            <select id="langSelector" class="px-3 py-2 bg-input-bg border border-border-color rounded-md text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-orange" onchange="changeLanguage()">
                <option value="ru">Русский</option>
                <option value="en">English</option>
            </select>
        </header>

        <p id="subtitle" class="text-text-secondary text-center mb-6">Настройте ваш оверлей для Twitch чата</p>

        <!-- Табы -->
        <div class="flex flex-wrap gap-2 mb-6 border-b border-border-color pb-2">
            <button class="tab active px-4 py-2 rounded-md bg-card-bg text-accent-orange font-medium border-l-2 border-accent-orange" data-tab="basic" id="tabBasic">Основное</button>
            <button class="tab px-4 py-2 rounded-md bg-primary-bg text-text-secondary hover:bg-card-bg hover:text-text-primary font-medium" data-tab="advanced" id="tabAdvanced">Дополнительно</button>
            <button class="tab px-4 py-2 rounded-md bg-primary-bg text-text-secondary hover:bg-card-bg hover:text-text-primary font-medium" data-tab="modules" id="tabModules">Модули</button>
        </div>

        <!-- Контент вкладок -->
        <div class="tab-content active space-y-6" id="basic-tab">
            <div class="bg-card-bg border border-border-color rounded-lg p-6">
                <h2 class="text-lg font-semibold text-accent-orange mb-4" id="basicSettingsTitle">Основные настройки</h2>
                <div class="space-y-6">
                    <div>
                        <label class="block text-text-primary mb-2" id="channelLabel">Имя канала</label>
                        <input id="channel" type="text" class="w-full px-4 py-2 bg-input-bg border border-border-color rounded-md text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-orange" placeholder="Введите имя канала" value="ikuza47" onchange="updateUrl()">
                        <p class="text-text-secondary text-sm mt-1" id="channelDesc">Введите имя Twitch-канала, с которого будет читаться чат</p>
                    </div>
                    <div>
                        <label class="block text-text-primary mb-2" id="fontLabel">Шрифт</label>
                        <select id="fontFamily" class="w-full px-4 py-2 bg-input-bg border border-border-color rounded-md text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-orange" onchange="updateUrl()">
                            <option value="'Segoe UI', sans-serif">Segoe UI</option>
                            <option value="Arial, sans-serif">Arial</option>
                            <option value="'Helvetica Neue', sans-serif">Helvetica</option>
                            <option value="'Open Sans', sans-serif">Open Sans</option>
                            <option value="'Roboto', sans-serif">Roboto</option>
                            <option value="'Inter', sans-serif">Inter</option>
                            <option value="system-ui">Системные шрифты</option>
                            <option value="custom">Другой шрифт...</option>
                        </select>
                        <input id="customFontInput" type="text" class="w-full mt-2 px-4 py-2 bg-input-bg border border-border-color rounded-md text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-orange hidden" placeholder="Введите название шрифта" onchange="updateUrl()">
                        <div class="font-preview text-text-secondary mt-2 px-2 py-1">Пример текста</div>
                        <p class="text-text-secondary text-sm mt-1" id="fontDesc">Выберите шрифт для отображения сообщений в чате</p>
                    </div>
                    <div>
                        <label class="block text-text-primary mb-2" id="sizeLabel">Размер шрифта</label>
                        <input id="fontSize" type="number" min="12" max="36" value="24" class="w-full px-4 py-2 bg-input-bg border border-border-color rounded-md text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-orange" onchange="updateUrl()">
                        <p class="text-text-secondary text-sm mt-1" id="sizeDesc">Размер текста в чате в пикселях</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content space-y-6 hidden" id="advanced-tab">
            <div class="bg-card-bg border border-border-color rounded-lg p-6">
                <h2 class="text-lg font-semibold text-accent-orange mb-4" id="advancedSettingsTitle">Дополнительные настройки</h2>
                <div class="space-y-6">
                    <!-- Новый параметр: Показывать время -->
                    <div class="flex items-start">
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="showTime" class="sr-only peer" onchange="toggleTimeSettings(); updateUrl();">
                            <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-orange"></div>
                        </label>
                        <div class="ml-3">
                            <label class="block text-text-primary" id="timeLabel">Показывать время</label>
                            <p class="text-text-secondary text-sm" id="timeDesc">Показывать текущее время в формате HH:MM перед ником</p>
                        </div>
                    </div>
                    
                    <!-- Настройки часового пояса (изначально скрыты) -->
                    <div id="timeSettings" class="hidden mt-4 p-4 bg-input-bg rounded-lg border border-border-color">
                        <label class="block text-text-primary mb-2" id="timeZoneLabel">Часовой пояс</label>
                        <select id="timeZone" class="w-full px-4 py-2 bg-input-bg border border-border-color rounded-md text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-orange" onchange="updateUrl()">
                            <option value="-12">UTC-12</option>
                            <option value="-11">UTC-11</option>
                            <option value="-10">UTC-10</option>
                            <option value="-9">UTC-9</option>
                            <option value="-8">UTC-8</option>
                            <option value="-7">UTC-7</option>
                            <option value="-6">UTC-6</option>
                            <option value="-5">UTC-5</option>
                            <option value="-4">UTC-4</option>
                            <option value="-3">UTC-3</option>
                            <option value="-2">UTC-2</option>
                            <option value="-1">UTC-1</option>
                            <option value="0" selected>UTC+0</option>
                            <option value="+1">UTC+1</option>
                            <option value="+2">UTC+2</option>
                            <option value="+3">UTC+3</option>
                            <option value="+4">UTC+4</option>
                            <option value="+5">UTC+5</option>
                            <option value="+6">UTC+6</option>
                            <option value="+7">UTC+7</option>
                            <option value="+8">UTC+8</option>
                            <option value="+9">UTC+9</option>
                            <option value="+10">UTC+10</option>
                            <option value="+11">UTC+11</option>
                            <option value="+12">UTC+12</option>
                            <option value="+13">UTC+13</option>
                            <option value="+14">UTC+14</option>
                        </select>
                        <p class="text-text-secondary text-sm mt-2" id="timeZoneDesc">Выберите часовой пояс для отображения времени</p>
                    </div>

                    <!-- Новый параметр: Отображать задний фон сообщений -->
                    <div class="flex items-start">
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="showBackground" class="sr-only peer" onchange="toggleBackgroundSettings(); updateUrl();">
                            <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-orange"></div>
                        </label>
                        <div class="ml-3">
                            <label class="block text-text-primary" id="backgroundLabel">Отображать задний фон сообщений</label>
                            <p class="text-text-secondary text-sm" id="backgroundDesc">Показывать полупрозрачный черный фон за сообщениями</p>
                        </div>
                    </div>
                    
                    <!-- Настройки фона (изначально скрыты) -->
                    <div id="backgroundSettings" class="hidden mt-4 p-4 bg-input-bg rounded-lg border border-border-color">
                        <label class="block text-text-primary mb-2" id="bgTransparencyLabel">Прозрачность фона</label>
                        <div class="slider-container">
                            <input type="range" id="bgTransparency" min="0" max="1" step="0.05" value="0.3" class="slider" oninput="updateBgTransparencyValue(); updateUrl();">
                            <span id="bgTransparencyValue" class="slider-value">0.30</span>
                        </div>
                        <p class="text-text-secondary text-sm mt-2" id="bgTransparencyDesc">0 = полностью прозрачный, 1 = непрозрачный</p>
                    </div>

                    <div class="flex items-start">
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="showBadges" class="sr-only peer" checked onchange="updateUrl()">
                            <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-orange"></div>
                        </label>
                        <div class="ml-3">
                            <label class="block text-text-primary" id="badgesLabel">Отображать бейджики</label>
                            <p class="text-text-secondary text-sm" id="badgesDesc">Показывать бейджики модератора, подписчика и т.д.</p>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="autoRemove" class="sr-only peer" onchange="toggleTimeout(); updateUrl();">
                            <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-orange"></div>
                        </label>
                        <div class="ml-3">
                            <label class="block text-text-primary" id="autoRemoveLabel">Автоудаление сообщений</label>
                            <p class="text-text-secondary text-sm" id="autoRemoveDesc">Автоматически удалять старые сообщения через указанное время</p>
                        </div>
                    </div>
                    <div id="timeoutGroup" class="hidden">
                        <label class="block text-text-primary mb-2" id="timeoutLabel">Время до удаления (сек)</label>
                        <input id="removeTimeout" type="number" min="3" max="30" value="5" class="w-full px-4 py-2 bg-input-bg border border-border-color rounded-md text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-orange" onchange="updateUrl()">
                        <p class="text-text-secondary text-sm mt-1" id="timeoutDesc">Через сколько секунд удалять сообщение</p>
                    </div>
                    <div class="flex items-start">
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="clearChatOnCommand" class="sr-only peer" checked onchange="updateUrl();">
                            <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-orange"></div>
                        </label>
                        <div class="ml-3">
                            <label class="block text-text-primary" id="clearChatLabel">Автоочистка чата</label>
                            <p class="text-text-secondary text-sm" id="clearChatDesc">Чат будет очищаться при команде /clear в Twitch</p>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="colonEnabled" class="sr-only peer" onchange="updateUrl();">
                            <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-orange"></div>
                        </label>
                        <div class="ml-3">
                            <label class="block text-text-primary" id="colonLabel">Добавлять двоеточие после ника</label>
                            <p class="text-text-secondary text-sm" id="colonDesc">Добавлять : после имени пользователя в сообщениях</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content space-y-6 hidden" id="modules-tab">
            <div class="bg-card-bg border border-border-color rounded-lg p-6">
                <h2 class="text-lg font-semibold text-accent-orange mb-4" id="modulesTitle">Модули</h2>
                <div class="space-y-6">
                    <!-- osu! -->
                    <div class="flex items-start">
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="osuModuleToggle" class="sr-only peer" onchange="toggleOsuSettings(); updateUrl();">
                            <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-orange"></div>
                        </label>
                        <div class="ml-3 flex-1">
                            <label class="block text-text-primary" id="osuModuleLabel">osu! модуль</label>
                            <p class="text-text-secondary text-sm" id="osuModuleDesc">Включает поддержку отображения информации о картах osu! по ссылке</p>
                            <div id="osuModuleSettings" class="mt-4 hidden">
                                <label class="block text-text-primary mb-2" id="osuApiKeyLabel">osu! API ключ</label>
                                <input id="osuApiKey" type="text" class="w-full px-4 py-2 bg-input-bg border border-border-color rounded-md text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-orange" placeholder="osu! API ключ" onchange="updateUrl()">
                                <p class="text-text-secondary text-sm mt-1">
                                    <a href="https://github.com/ikuza47/ikuzachat/blob/main/publics/howgetosuapi.md" id="osuApiLink" class="text-accent-orange hover:underline" target="_blank" id="osuApiLinkText">Instruction</a>
                                </p>

                                <!-- Новые настройки osu! -->
                                <div class="mt-4 space-y-4">
                                    <div class="flex items-start">
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" id="osuMap" class="sr-only peer" checked onchange="updateUrl();">
                                            <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-orange"></div>
                                        </label>
                                        <div class="ml-3">
                                            <label class="block text-text-primary" id="osuMapLabel">Парсинг карты</label>
                                            <p class="text-text-secondary text-sm" id="osuMapDesc">Парсит ссылку на мапу и выводит информацию</p>
                                        </div>
                                    </div>

                                    <div class="flex items-start">
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" id="osuScore" class="sr-only peer" disabled onchange="updateUrl();">
                                            <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-orange opacity-50 cursor-not-allowed"></div>
                                        </label>
                                        <div class="ml-3">
                                            <label class="block text-text-primary" id="osuScoreLabel">Парсинг скоры</label>
                                            <p class="text-text-secondary text-sm" id="osuScoreDesc">Парсит ссылку на скор и выводит информацию о скоре (не работает)</p>
                                        </div>
                                    </div>

                                    <div class="flex items-start">
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" id="osuUser" class="sr-only peer" checked onchange="updateUrl();">
                                            <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-orange"></div>
                                        </label>
                                        <div class="ml-3">
                                            <label class="block text-text-primary" id="osuUserLabel">Парсинг юзера</label>
                                            <p class="text-text-secondary text-sm" id="osuUserDesc">Парсит ссылку на юзера и выводит информацию о нём</p>
                                        </div>
                                    </div>

                                    <div class="flex items-start">
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" id="osuHighlight" class="sr-only peer" onchange="updateUrl();">
                                            <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-orange"></div>
                                        </label>
                                        <div class="ml-3">
                                            <label class="block text-text-primary" id="osuHighlightLabel">Выделять информацию</label>
                                            <p class="text-text-secondary text-sm" id="osuHighlightDesc">Меняет часть текста на другой цвет: \n Карта - розовый \n Скор - жёлтый \n Юзер - синий</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Блокировка ботов -->
                    <div class="flex items-start">
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="botModuleToggle" class="sr-only peer" onchange="updateUrl();">
                            <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-orange"></div>
                        </label>
                        <div class="ml-3">
                            <label class="block text-text-primary" id="botModuleLabel">Блокировка ботов</label>
                            <p class="text-text-secondary text-sm" id="botModuleDesc">Скрывать сообщения от ботов (список загружается с GitHub)</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Кнопки -->
        <div class="flex flex-col sm:flex-row gap-3 mt-6">
            <button class="btn flex-1 px-4 py-2 bg-accent-orange hover:bg-accent-orange-hover text-button-text rounded-md font-medium transition" onclick="copyUrl()" id="copyBtnText">
                <i class="fas fa-copy mr-2"></i>
                Скопировать ссылку
            </button>
            <button class="btn flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-md font-medium transition" onclick="resetSettings()" id="resetBtnText">
                <i class="fas fa-redo mr-2"></i>
                Сбросить
            </button>
        </div>

        <!-- Ссылка -->
        <div class="mt-6 p-4 bg-card-bg border border-border-color rounded-lg">
            <div class="bg-input-bg border border-border-color rounded-md p-3">
                <input id="overlayUrl" type="text" readonly class="w-full bg-transparent text-accent-orange outline-none font-mono text-sm" value="">
            </div>
        </div>
    </div>

    <script src="index.js"></script>
</body>
</html>